---

title: Omeka S API client


keywords: fastai
sidebar: home_sidebar

summary: "Tools to interact with the Omeka S REST API"
description: "Tools to interact with the Omeka S REST API"
nb_path: "api.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: api.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="OmekaAPIClient" class="doc_header"><code>class</code> <code>OmekaAPIClient</code><a href="https://github.com/wragge/omeka_s_tools/tree/master/omeka_s_tools/api.py#L17" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>OmekaAPIClient</code>(<strong><code>api_url</code></strong>, <strong><code>key_identity</code></strong>=<em><code>None</code></em>, <strong><code>key_credential</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To initialise the <a href="/omeka_s_tools/api.html#OmekaAPIClient"><code>OmekaAPIClient</code></a> you need to provide the base url of your Omeka instance's API.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka</span> <span class="o">=</span> <span class="n">OmekaAPIClient</span><span class="p">(</span><span class="s1">&#39;http://timsherratt.org/collections/api&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will let you access details of all public resources provided by your Omeka instance. To access private resources, or create new resources, you'll have to authenticate your API requests by provide a <code>key_identity</code> and <code>key_credential</code>. See <a href="#Adding-items">Adding items</a> for an example.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-resources">Getting resources<a class="anchor-link" href="#Getting-resources"> </a></h2><p>You can find a <a href="https://omeka.org/s/docs/developer/api/#resources">full list of Omeka's resources</a> in the API documentation. You're most likely to be interested in 'items', but accessing 'properties' and 'resource_templates' can be useful when you're creating new resources.</p>
<p>You should be able to use <code>get_resources</code> with any of the resource types, though some of the parameters will be different.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_resources" class="doc_header"><code>OmekaAPIClient.get_resources</code><a href="__main__.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_resources</code>(<strong><code>resource_type</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Get a list of resources matching the supplied parameters.
This will return the first page of matching results. To retrieve additional pages, 
you can supply the <code>page</code> parameter to move through the full result set.</p>
<p>Parameters:</p>
<ul>
<li><code>resource_type</code> - one of Omeka's resource types, eg: 'items', 'properties'</li>
<li>there are many additional parameters you can supply as kwargs, see the Omeka documention</li>
</ul>
<p>Returns a dict with the following values:</p>
<ul>
<li><code>total_results</code> - number of matching resources</li>
<li><code>results</code> - a list of dicts, each containing a JSON-LD formatted representation of a resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">)</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_results&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>30</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;total_results&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;resource_templates&#39;</span><span class="p">)</span>
<span class="n">first_template</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">first_template</span><span class="p">[</span><span class="s1">&#39;@type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;o:ResourceTemplate&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_resource_by_id" class="doc_header"><code>OmekaAPIClient.get_resource_by_id</code><a href="__main__.py#L83" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_resource_by_id</code>(<strong><code>resource_id</code></strong>, <strong><code>resource_type</code></strong>=<em><code>'items'</code></em>)</p>
</blockquote>
<p>Get a resource from its Omeka id.</p>
<p>Parameters:</p>
<ul>
<li><code>resource_id</code> - numeric identifier used by Omeka for this resource</li>
<li><code>resource_type</code> - one of Omeka's resource types, eg: 'items', 'properties'</li>
</ul>
<p>Returns</p>
<ul>
<li>a dict containing a JSON-LD formatted representation of the resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">)</span>
<span class="n">random_item</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;results&#39;</span><span class="p">])</span>
<span class="n">item_id</span> <span class="o">=</span> <span class="n">random_item</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span>

<span class="c1"># Get the same item using its id</span>
<span class="n">item_from_id</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resource_by_id</span><span class="p">(</span><span class="n">item_id</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">)</span>

<span class="c1"># Check that they&#39;re the same</span>
<span class="k">assert</span> <span class="n">random_item</span> <span class="o">==</span> <span class="n">item_from_id</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It can be difficult to remember all the available parameters and the differences between resource types, so I've created a number of more specialised methods that are really just wrappers around <code>get_resources</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_template_by_label" class="doc_header"><code>OmekaAPIClient.get_template_by_label</code><a href="__main__.py#L97" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_template_by_label</code>(<strong><code>label</code></strong>)</p>
</blockquote>
<p>Get a resource template from its Omeka label.</p>
<p>Parameters:</p>
<ul>
<li><code>label</code> - the name of the resource template in Omeka (eg. 'NewspaperArticle')</li>
</ul>
<p>Returns:</p>
<ul>
<li>dict containing representation of the template</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newspaper_template</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_template_by_label</span><span class="p">(</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">newspaper_template</span><span class="p">[</span><span class="s1">&#39;@type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;o:ResourceTemplate&#39;</span>
<span class="k">assert</span> <span class="n">newspaper_template</span><span class="p">[</span><span class="s1">&#39;o:label&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Newspaper&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template_from_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;resource_templates&#39;</span><span class="p">)[</span><span class="s1">&#39;results&#39;</span><span class="p">])</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">template_from_list</span><span class="p">[</span><span class="s1">&#39;o:label&#39;</span><span class="p">]</span>

<span class="c1"># Get the template using label</span>
<span class="n">template_from_label</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_template_by_label</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># Check they&#39;re both the same</span>
<span class="k">assert</span> <span class="n">template_from_list</span> <span class="o">==</span> <span class="n">template_from_label</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_resource_by_term" class="doc_header"><code>OmekaAPIClient.get_resource_by_term</code><a href="__main__.py#L109" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_resource_by_term</code>(<strong><code>term</code></strong>, <strong><code>resource_type</code></strong>=<em><code>'properties'</code></em>)</p>
</blockquote>
<p>Get the resource (property or class) associated with the suppied term.</p>
<p>Parameters:</p>
<ul>
<li><code>term</code> - property label qualified with vocabulary prefix (eg: 'schema:name')</li>
</ul>
<p>Returns:</p>
<ul>
<li>dict containing representation of the resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resource_by_term</span><span class="p">(</span><span class="s1">&#39;schema:name&#39;</span><span class="p">)</span>
<span class="n">prop</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
 &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/properties/1116&#39;,
 &#39;@type&#39;: &#39;o:Property&#39;,
 &#39;o:id&#39;: 1116,
 &#39;o:local_name&#39;: &#39;name&#39;,
 &#39;o:label&#39;: &#39;name&#39;,
 &#39;o:comment&#39;: &#39;The name of the item.&#39;,
 &#39;o:term&#39;: &#39;schema:name&#39;,
 &#39;o:vocabulary&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/vocabularies/5&#39;,
  &#39;o:id&#39;: 5}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_resource_from_vocab" class="doc_header"><code>OmekaAPIClient.get_resource_from_vocab</code><a href="__main__.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_resource_from_vocab</code>(<strong><code>local_name</code></strong>, <strong><code>vocabulary_namespace_uri</code></strong>=<em><code>'http://schema.org/'</code></em>, <strong><code>resource_type</code></strong>=<em><code>'properties'</code></em>)</p>
</blockquote>
<p>Get the resource (property or class) associated with the suppied vocabulary and label.</p>
<p>Parameters:</p>
<ul>
<li><code>local_name</code> - label of the property or class</li>
<li><code>vocabulary_namespace_uri</code> - URI defining the vocab</li>
</ul>
<p>Returns:</p>
<ul>
<li>dict containing representation of the resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resource_from_vocab</span><span class="p">(</span>
    <span class="s1">&#39;name&#39;</span><span class="p">,</span> 
    <span class="n">vocabulary_namespace_uri</span><span class="o">=</span><span class="s1">&#39;http://schema.org/&#39;</span><span class="p">,</span>
    <span class="n">resource_type</span><span class="o">=</span><span class="s1">&#39;properties&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
 &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/properties/1116&#39;,
 &#39;@type&#39;: &#39;o:Property&#39;,
 &#39;o:id&#39;: 1116,
 &#39;o:local_name&#39;: &#39;name&#39;,
 &#39;o:label&#39;: &#39;name&#39;,
 &#39;o:comment&#39;: &#39;The name of the item.&#39;,
 &#39;o:term&#39;: &#39;schema:name&#39;,
 &#39;o:vocabulary&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/vocabularies/5&#39;,
  &#39;o:id&#39;: 5}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.get_property_id" class="doc_header"><code>OmekaAPIClient.get_property_id</code><a href="__main__.py#L134" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.get_property_id</code>(<strong><code>term</code></strong>)</p>
</blockquote>
<p>Get the numeric identifier associated with the supplied property term.</p>
<p>Parameters:</p>
<ul>
<li><code>term</code> - property label qualified with vocabulary prefix (eg: 'schema:name')</li>
</ul>
<p>Returns:</p>
<ul>
<li>numeric identifier</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka</span><span class="o">.</span><span class="n">get_property_id</span><span class="p">(</span><span class="s1">&#39;schema:name&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1116</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.filter_items_by_property" class="doc_header"><code>OmekaAPIClient.filter_items_by_property</code><a href="__main__.py#L155" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.filter_items_by_property</code>(<strong><code>filter_property</code></strong>=<em><code>'schema:name'</code></em>, <strong><code>filter_value</code></strong>=<em><code>''</code></em>, <strong><code>filter_type</code></strong>=<em><code>'eq'</code></em>, <strong><code>page</code></strong>=<em><code>1</code></em>, <strong>**<code>extra_filters</code></strong>)</p>
</blockquote>
<p>Filter the list of items by searching for a value in a particular property.
Additional filters can also limit to items associated with particular templates, classes, or item sets.</p>
<p>Parameters:</p>
<ul>
<li><code>filter_property</code> - property term (eg: 'schema:name')</li>
<li><code>filter_value</code> - the value you want to find</li>
<li><code>filter_type</code> - how <code>filter_value</code> should be compared to the stored values (eg: 'eq')</li>
<li><code>page</code> - number of results page</li>
</ul>
<p>Additional parameters:</p>
<ul>
<li><code>resource_template_id</code> - numeric identifier</li>
<li><code>resource_class_id</code> - numeric identifier</li>
<li><code>item_set_id</code> - numeric identifier</li>
<li><code>is_public</code> - boolean, True or False</li>
</ul>
<p>Returns a dict with the following values:</p>
<ul>
<li><code>total_results</code> - number of matching resources</li>
<li><code>results</code> - a list of dicts, each containing a JSON-LD formatted representation of a resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka</span><span class="o">.</span><span class="n">filter_items_by_property</span><span class="p">(</span><span class="n">search_property</span><span class="o">=</span><span class="s1">&#39;schema:name&#39;</span><span class="p">,</span> <span class="n">search_text</span><span class="o">=</span><span class="s1">&#39;name1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;total_results&#39;: &#39;3&#39;,
 &#39;results&#39;: [{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
   &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/694&#39;,
   &#39;@type&#39;: &#39;o:Item&#39;,
   &#39;o:id&#39;: 694,
   &#39;o:is_public&#39;: True,
   &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
    &#39;o:id&#39;: 1},
   &#39;o:resource_class&#39;: None,
   &#39;o:resource_template&#39;: None,
   &#39;o:thumbnail&#39;: None,
   &#39;o:title&#39;: None,
   &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: None, &#39;medium&#39;: None, &#39;square&#39;: None},
   &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-24T03:56:55+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-24T03:56:55+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:media&#39;: [],
   &#39;o:item_set&#39;: [],
   &#39;o:site&#39;: [],
   &#39;schema:name&#39;: [{&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name1&#39;},
    {&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name2&#39;}]},
  {&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
   &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/695&#39;,
   &#39;@type&#39;: &#39;o:Item&#39;,
   &#39;o:id&#39;: 695,
   &#39;o:is_public&#39;: True,
   &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
    &#39;o:id&#39;: 1},
   &#39;o:resource_class&#39;: None,
   &#39;o:resource_template&#39;: None,
   &#39;o:thumbnail&#39;: None,
   &#39;o:title&#39;: None,
   &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: None, &#39;medium&#39;: None, &#39;square&#39;: None},
   &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-24T04:05:41+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-24T04:05:41+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:media&#39;: [],
   &#39;o:item_set&#39;: [],
   &#39;o:site&#39;: [],
   &#39;schema:name&#39;: [{&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name1&#39;},
    {&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name2&#39;}]},
  {&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
   &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/696&#39;,
   &#39;@type&#39;: &#39;o:Item&#39;,
   &#39;o:id&#39;: 696,
   &#39;o:is_public&#39;: True,
   &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
    &#39;o:id&#39;: 1},
   &#39;o:resource_class&#39;: None,
   &#39;o:resource_template&#39;: None,
   &#39;o:thumbnail&#39;: None,
   &#39;o:title&#39;: None,
   &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: None, &#39;medium&#39;: None, &#39;square&#39;: None},
   &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-24T04:07:26+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-24T04:07:26+00:00&#39;,
    &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
   &#39;o:media&#39;: [],
   &#39;o:item_set&#39;: [],
   &#39;o:site&#39;: [],
   &#39;schema:name&#39;: [{&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name1&#39;},
    {&#39;type&#39;: &#39;literal&#39;,
     &#39;property_id&#39;: 1116,
     &#39;property_label&#39;: &#39;name&#39;,
     &#39;is_public&#39;: True,
     &#39;@value&#39;: &#39;name2&#39;}]}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.search_items" class="doc_header"><code>OmekaAPIClient.search_items</code><a href="__main__.py#L191" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.search_items</code>(<strong><code>query</code></strong>, <strong><code>search_type</code></strong>=<em><code>'fulltext_search'</code></em>, <strong><code>page</code></strong>=<em><code>1</code></em>, <strong>**<code>extra_filters</code></strong>)</p>
</blockquote>
<p>Search for matching items.
Two search types are available:</p>
<ul>
<li>'search` - looks for an exact match of the query in a property value</li>
<li>'fulltext_search` - looks for the occurance of the query anywhere</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>query</code> - the text you want to search for</li>
<li><code>search_type</code> - one of 'fulltext_search' or 'search'</li>
<li><code>page</code> - number of results page</li>
</ul>
<p>Additional parameters:</p>
<ul>
<li><code>resource_template_id</code> - numeric identifier</li>
<li><code>resource_class_id</code> - numeric identifier</li>
<li><code>item_set_id</code> - numeric identifier</li>
<li><code>is_public</code> - boolean, True or False</li>
</ul>
<p>Returns a dict with the following values:</p>
<ul>
<li><code>total_results</code> - number of matching resources</li>
<li><code>results</code> - a list of dicts, each containing a JSON-LD formatted representation of a resource</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">search_items</span><span class="p">(</span><span class="s1">&#39;Newcastle&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_from_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">))</span>

<span class="c1"># Get the same item using its id</span>
<span class="n">item_from_id</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resource_by_id</span><span class="p">(</span><span class="n">item_from_list</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">])</span>

<span class="c1"># Check that they&#39;re the same</span>
<span class="k">assert</span> <span class="n">item_from_list</span> <span class="o">==</span> <span class="n">item_from_id</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template_from_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;resource_templates&#39;</span><span class="p">))</span>
<span class="n">template_from_label</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_resource_by_label</span><span class="p">(</span><span class="n">template_from_list</span><span class="p">[</span><span class="s1">&#39;o:label&#39;</span><span class="p">],</span> <span class="s1">&#39;resource_templates&#39;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">template_from_list</span> <span class="o">==</span> <span class="n">template_from_label</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">property_from_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">))</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">property_from_list</span><span class="p">[</span><span class="s1">&#39;o:vocabulary&#39;</span><span class="p">][</span><span class="s1">&#39;@id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">vocab_namespace_uri</span> <span class="o">=</span> <span class="n">vocabulary</span><span class="p">[</span><span class="s1">&#39;o:namespace_uri&#39;</span><span class="p">]</span>
<span class="n">property_id</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">get_rdf_resource_id</span><span class="p">(</span><span class="n">property_from_list</span><span class="p">[</span><span class="s1">&#39;o:local_name&#39;</span><span class="p">],</span> <span class="n">vocabulary_namespace_uri</span><span class="o">=</span><span class="n">vocab_namespace_uri</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">property_from_list</span><span class="p">[</span><span class="s1">&#39;@id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">property_id</span><span class="p">[</span><span class="s1">&#39;@id&#39;</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">property_from_list</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">property_id</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span>         
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">item_from_list</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">omeka</span><span class="o">.</span><span class="n">get_resources</span><span class="p">(</span><span class="s1">&#39;items&#39;</span><span class="p">))</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">item_from_list</span><span class="p">[</span><span class="s1">&#39;schema:name&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;@value&#39;</span><span class="p">]</span>

<span class="n">found_item</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">find_item</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">property_name</span><span class="o">=</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">vocabulary_namespace_uri</span><span class="o">=</span><span class="s1">&#39;http://schema.org/&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">found_item</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">item_from_list</span> <span class="o">==</span> <span class="n">found_item</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Adding-items">Adding items<a class="anchor-link" href="#Adding-items"> </a></h2><p>To add resources to Omeka you need authenticate your API requests by supplying <code>key_identity</code> and <code>key_credential</code> tokens as parameters.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka_auth</span> <span class="o">=</span> <span class="n">OmekaAPIClient</span><span class="p">(</span>
    <span class="n">api_url</span><span class="o">=</span><span class="s1">&#39;http://timsherratt.org/collections/api&#39;</span><span class="p">,</span>
    <span class="n">key_identity</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;KEY_IDENTITY&#39;</span><span class="p">),</span> 
    <span class="n">key_credential</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;KEY_CREDENTIAL&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are two stages in creating a new item:</p>
<ul>
<li>prepare a payload containing the item data in the format expected by Omeka</li>
<li>upload the payload to Omeka</li>
</ul>
<h3 id="Prepare-an-item-payload">Prepare an item payload<a class="anchor-link" href="#Prepare-an-item-payload"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.prepare_item_payload" class="doc_header"><code>OmekaAPIClient.prepare_item_payload</code><a href="__main__.py#L308" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.prepare_item_payload</code>(<strong><code>terms</code></strong>)</p>
</blockquote>
<p>Prepare an item payload, ready for upload.</p>
<p>Parameters:</p>
<ul>
<li><code>terms</code>: a dict of terms, values, and (optionally) data types</li>
</ul>
<p>Returns:</p>
<ul>
<li>the payload dict</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_item</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;dcterms:title&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;My first resource!&#39;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">payload</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">prepare_item</span><span class="p">(</span><span class="n">test_item</span><span class="p">)</span>
<span class="n">payload</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;dcterms:title&#39;: [{&#39;property_id&#39;: 1,
   &#39;type&#39;: &#39;literal&#39;,
   &#39;@value&#39;: &#39;My first resource!&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each term in the payload should have values for <code>property_id</code> and <code>type</code>, and the property value should be included as either <code>@id</code> or <code>@value</code> depending on the data type.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_property</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">payload</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="k">assert</span> <span class="s1">&#39;property_id&#39;</span> <span class="ow">in</span> <span class="n">first_property</span>
<span class="k">assert</span> <span class="s1">&#39;type&#39;</span> <span class="ow">in</span> <span class="n">first_property</span>
<span class="k">assert</span> <span class="s1">&#39;@value&#39;</span> <span class="ow">in</span> <span class="n">first_property</span> <span class="ow">or</span> <span class="s1">&#39;@id&#39;</span> <span class="ow">in</span> <span class="n">first_property</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the powerful features of Omeka S is the ability to create resource templates that define a set of properties for a particular type of item. We can use templates to help create our payload, ensuring that the terms and data types we supply match those expected by the template. This is useful for identifying potential problems before we upload to Omeka, especially as Omeka will sometimes just fail silently.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.prepare_item_payload_using_template" class="doc_header"><code>OmekaAPIClient.prepare_item_payload_using_template</code><a href="__main__.py#L332" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.prepare_item_payload_using_template</code>(<strong><code>terms</code></strong>, <strong><code>template_id</code></strong>)</p>
</blockquote>
<p>Prepare an item payload, checking the supplied terms and values against the specified template.
Note:</p>
<ul>
<li>terms that are not in the template will generate a warning and be dropped from the payload</li>
<li>data types that don't match the template definitions will generate a warning and the term will be dropped from the payload</li>
<li>if no data type is supplied, a type that conforms with the template definition will be used</li>
</ul>
<p>Parameters:</p>
<ul>
<li><code>terms</code>: a dict of terms, values, and (optionally) data types</li>
<li><code>template_id</code>: Omeka's internal numeric identifier for the template</li>
</ul>
<p>Returns:</p>
<ul>
<li>the payload dict</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once you've created a payload, you can add paths to any media files that you want to be attached to the item.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.add_media_to_payload" class="doc_header"><code>OmekaAPIClient.add_media_to_payload</code><a href="__main__.py#L378" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.add_media_to_payload</code>(<strong><code>payload</code></strong>, <strong><code>media_files</code></strong>)</p>
</blockquote>
<p>Add media files to the item payload.</p>
<p>Parameters:</p>
<ul>
<li><code>payload</code> - the payload dict to be modified</li>
<li><code>media_files</code> - media files to be uploaded</li>
</ul>
<p>The value of <code>media_files</code> can be either:</p>
<ul>
<li>a list of paths to the image/media files (filename is used as title)</li>
<li>a list of dicts, each containing <code>title</code>, and <code>path</code> values</li>
</ul>
<p>Returns:</p>
<ul>
<li>the modified payload dict</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Upload-the-payload-to-Omeka-and-create-a-new-item">Upload the payload to Omeka and create a new item<a class="anchor-link" href="#Upload-the-payload-to-Omeka-and-create-a-new-item"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="OmekaAPIClient.add_item" class="doc_header"><code>OmekaAPIClient.add_item</code><a href="__main__.py#L281" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>OmekaAPIClient.add_item</code>(<strong><code>payload</code></strong>, <strong><code>media_files</code></strong>=<em><code>None</code></em>, <strong><code>template_id</code></strong>=<em><code>None</code></em>, <strong><code>class_id</code></strong>=<em><code>None</code></em>, <strong><code>item_set_id</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Create a new item from the supplied payload, optionally uploading attached media files.</p>
<p>Parameters:</p>
<ul>
<li><code>payload</code> - a dict generated by <code>prepare_item_payload()</code> or <code>prepare_item_payload_using_template()</code></li>
<li><code>media_files</code> - a list of paths pointing to media files, or a list of dicts with <code>path</code> and <code>title</code> values</li>
<li><code>template_id</code> - internal Omeka identifier of a resource template you want to attach to this item</li>
<li><code>class_id</code> - internal Omeka identifier of a resource class you want to attach to this item</li>
<li><code>item_set_id</code> - internal Omeka identifier for an item set you want to add this item to</li>
</ul>
<p>Returns:</p>
<ul>
<li>a dict providing the JSON-LD representation of the new item from Omeka</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Add-a-simple-item">Add a simple item<a class="anchor-link" href="#Add-a-simple-item"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka_auth</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
 &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/710&#39;,
 &#39;@type&#39;: &#39;o:Item&#39;,
 &#39;o:id&#39;: 710,
 &#39;o:is_public&#39;: True,
 &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
  &#39;o:id&#39;: 1},
 &#39;o:resource_class&#39;: None,
 &#39;o:resource_template&#39;: None,
 &#39;o:thumbnail&#39;: None,
 &#39;o:title&#39;: &#39;My first resource!&#39;,
 &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: None, &#39;medium&#39;: None, &#39;square&#39;: None},
 &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-25T04:09:55+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-25T04:09:55+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:media&#39;: [],
 &#39;o:item_set&#39;: [],
 &#39;o:site&#39;: [],
 &#39;dcterms:title&#39;: [{&#39;type&#39;: &#39;literal&#39;,
   &#39;property_id&#39;: 1,
   &#39;property_label&#39;: &#39;Title&#39;,
   &#39;is_public&#39;: True,
   &#39;@value&#39;: &#39;My first resource!&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">id_url</span> <span class="o">=</span> <span class="n">omeka</span><span class="o">.</span><span class="n">format_resource_id</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;resource_templates&#39;</span><span class="p">)</span>

<span class="k">assert</span> <span class="n">id_url</span> <span class="o">==</span> <span class="p">{</span>
    <span class="s1">&#39;@id&#39;</span><span class="p">:</span> <span class="s1">&#39;http://timsherratt.org/collections/api/resource_templates/5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;o:id&#39;</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">media_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;images/image1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;images/image2.png&#39;</span><span class="p">]</span>
<span class="n">item</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">prepare_item_using_template</span><span class="p">(</span><span class="n">test_item</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="n">omeka_auth</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">template_id</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">media_files</span><span class="o">=</span><span class="n">media_files</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Utilities">Utilities<a class="anchor-link" href="#Utilities"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-adding-a-newspaper-article-from-Trove">Example: adding a newspaper article from Trove<a class="anchor-link" href="#Example:-adding-a-newspaper-article-from-Trove"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the example below I'm going to manually step through the process of adding a new item to Omeka using the API in order to demonstrate the methods available. But of course the point of using the API is to automate such processes -- joining together the individual steps so they can be embedded into your own systems or workflows.</p>
<p>Let's suppose we want to add this newspaper article in Trove to our Omeka instance. To take best advantage of Omeka's linked data infrastructure, we'll actually create two resources -- one for the article, and one for the newspaper it was published in.</p>
<p>I've already created templates labelled 'Newspaper' and 'Newspaper article'.</p>
<p>Let's start with the newspaper. First we need to find out the numeric identifier Omeka is using for the Newspaper template. We can use <a href="/omeka_s_tools/api.html#OmekaAPIClient.get_template_by_label"><code>OmekaAPIClient.get_template_by_label</code></a> to find out.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka_auth</span> <span class="o">=</span> <span class="n">OmekaAPIClient</span><span class="p">(</span>
    <span class="n">api_url</span><span class="o">=</span><span class="s1">&#39;http://timsherratt.org/collections/api&#39;</span><span class="p">,</span>
    <span class="n">key_identity</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;KEY_IDENTITY&#39;</span><span class="p">),</span> 
    <span class="n">key_credential</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;KEY_CREDENTIAL&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">newspaper_template_id</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">get_template_by_label</span><span class="p">(</span><span class="s1">&#39;Newspaper&#39;</span><span class="p">)[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span>
<span class="n">newspaper_template_id</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For convenience, we can get a summary of the properties used in the Newspaper template using <a href="/omeka_s_tools/api.html#OmekaAPIClient.get_template_properties"><code>OmekaAPIClient.get_template_properties</code></a>. This is useful if we want to check which properties are in use, and what data types are expected.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">omeka_auth</span><span class="o">.</span><span class="n">get_template_properties</span><span class="p">(</span><span class="n">newspaper_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;schema:name&#39;: {&#39;property_id&#39;: 1116, &#39;type&#39;: [&#39;literal&#39;]},
 &#39;schema:additionalType&#39;: {&#39;property_id&#39;: 1199, &#39;type&#39;: [&#39;uri&#39;]},
 &#39;schema:description&#39;: {&#39;property_id&#39;: 528,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:alternateName&#39;: {&#39;property_id&#39;: 282,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:editor&#39;: {&#39;property_id&#39;: 752, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:publisher&#39;: {&#39;property_id&#39;: 967, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:issn&#39;: {&#39;property_id&#39;: 931,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:startDate&#39;: {&#39;property_id&#39;: 513, &#39;type&#39;: [&#39;numeric:timestamp&#39;]},
 &#39;schema:endDate&#39;: {&#39;property_id&#39;: 657, &#39;type&#39;: [&#39;numeric:timestamp&#39;]},
 &#39;schema:locationCreated&#39;: {&#39;property_id&#39;: 706, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:hasPart&#39;: {&#39;property_id&#39;: 1405, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:about&#39;: {&#39;property_id&#39;: 1392, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:mentions&#39;: {&#39;property_id&#39;: 747, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:contentLocation&#39;: {&#39;property_id&#39;: 1419, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:temporalCoverage&#39;: {&#39;property_id&#39;: 460,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:subjectOf&#39;: {&#39;property_id&#39;: 1391, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:url&#39;: {&#39;property_id&#39;: 393, &#39;type&#39;: [&#39;uri&#39;]},
 &#39;schema:image&#39;: {&#39;property_id&#39;: 742, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:identifier&#39;: {&#39;property_id&#39;: 190,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:sameAs&#39;: {&#39;property_id&#39;: 246, &#39;type&#39;: [&#39;uri&#39;]}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first step in preparing our data for upload is to create a dictionary, using the required property terms as keys. In this case, we'll assign data about the newspaper to <code>schema.name</code> and <code>schema.url</code>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newspaper</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;schema.name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;literal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;schema:url&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;literal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;http://nla.gov.au/nla.news-title806&#39;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can use this data to create a payload for upload to Omeka. <a href="/omeka_s_tools/api.html#OmekaAPIClient.prepare_item_payload_using_template"><code>OmekaAPIClient.prepare_item_payload_using_template</code></a> will check our data against the Newspaper template and build the payload.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">payload</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">prepare_item_payload_using_template</span><span class="p">(</span><span class="n">newspaper</span><span class="p">,</span> <span class="n">newspaper_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Term schema.name not in template
Data type &#34;literal&#34; for term &#34;schema:url&#34; not allowed by template
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Whoops! It seems we have some problems with our data file! First of all we've used a full stop, rather than a colon in <code>schema:name</code>. Second, we've said the data type of <code>schema:url</code> is 'literal', but if we check the template properties we'll see it' should be 'uri'. Let's make these changes.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newspaper</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;schema:name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;literal&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s1">&#39;schema:url&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;uri&#39;</span><span class="p">,</span>
            <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;http://nla.gov.au/nla.news-title806&#39;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">payload</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">prepare_item_payload_using_template</span><span class="p">(</span><span class="n">newspaper</span><span class="p">,</span> <span class="n">newspaper_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>That seems better! Now we can examine the payload.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">payload</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;schema:name&#39;: [{&#39;property_id&#39;: 1116,
   &#39;type&#39;: &#39;literal&#39;,
   &#39;@value&#39;: &#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;}],
 &#39;schema:url&#39;: [{&#39;property_id&#39;: 393,
   &#39;type&#39;: &#39;uri&#39;,
   &#39;@id&#39;: &#39;http://nla.gov.au/nla.news-title806&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how the values have been reformatted? They should now be ready to upload to Omeka using <a href="/omeka_s_tools/api.html#OmekaAPIClient.add_item"><code>OmekaAPIClient.add_item</code></a>. We'll supply both the payload and the newspaper template id.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newspaper_item</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">template_id</span><span class="o">=</span><span class="n">newspaper_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check the contents of <code>newspaper_item</code> to make sure it's been added succesfully.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">newspaper_item</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
 &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/712&#39;,
 &#39;@type&#39;: &#39;o:Item&#39;,
 &#39;o:id&#39;: 712,
 &#39;o:is_public&#39;: True,
 &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
  &#39;o:id&#39;: 1},
 &#39;o:resource_class&#39;: None,
 &#39;o:resource_template&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/resource_templates/5&#39;,
  &#39;o:id&#39;: 5},
 &#39;o:thumbnail&#39;: None,
 &#39;o:title&#39;: &#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;,
 &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: None, &#39;medium&#39;: None, &#39;square&#39;: None},
 &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-25T12:11:22+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-25T12:11:22+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:media&#39;: [],
 &#39;o:item_set&#39;: [],
 &#39;o:site&#39;: [],
 &#39;schema:name&#39;: [{&#39;type&#39;: &#39;literal&#39;,
   &#39;property_id&#39;: 1116,
   &#39;property_label&#39;: &#39;name&#39;,
   &#39;is_public&#39;: True,
   &#39;@value&#39;: &#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;}],
 &#39;schema:url&#39;: [{&#39;type&#39;: &#39;uri&#39;,
   &#39;property_id&#39;: 393,
   &#39;property_label&#39;: &#39;url&#39;,
   &#39;is_public&#39;: True,
   &#39;@id&#39;: &#39;http://nla.gov.au/nla.news-title806&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Great! Now what about the article? Again let's start by having a look at the 'Newspaper article' template.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article_template_id</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">get_template_by_label</span><span class="p">(</span><span class="s1">&#39;Newspaper article&#39;</span><span class="p">)[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]</span>
<span class="n">omeka_auth</span><span class="o">.</span><span class="n">get_template_properties</span><span class="p">(</span><span class="n">article_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;schema:name&#39;: {&#39;property_id&#39;: 1116,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:additionalType&#39;: {&#39;property_id&#39;: 1199, &#39;type&#39;: [&#39;uri&#39;]},
 &#39;schema:description&#39;: {&#39;property_id&#39;: 528,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:alternateName&#39;: {&#39;property_id&#39;: 282,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:datePublished&#39;: {&#39;property_id&#39;: 928, &#39;type&#39;: [&#39;numeric:timestamp&#39;]},
 &#39;schema:pagination&#39;: {&#39;property_id&#39;: 376,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:creator&#39;: {&#39;property_id&#39;: 329, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:contributor&#39;: {&#39;property_id&#39;: 1303, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:isPartOf&#39;: {&#39;property_id&#39;: 736, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:license&#39;: {&#39;property_id&#39;: 1348,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:about&#39;: {&#39;property_id&#39;: 1392, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:mentions&#39;: {&#39;property_id&#39;: 747, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:contentLocation&#39;: {&#39;property_id&#39;: 1419, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:temporalCoverage&#39;: {&#39;property_id&#39;: 460,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:subjectOf&#39;: {&#39;property_id&#39;: 1391, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:image&#39;: {&#39;property_id&#39;: 742, &#39;type&#39;: [&#39;resource:item&#39;]},
 &#39;schema:url&#39;: {&#39;property_id&#39;: 393, &#39;type&#39;: [&#39;uri&#39;]},
 &#39;schema:identifier&#39;: {&#39;property_id&#39;: 190,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]},
 &#39;schema:sameAs&#39;: {&#39;property_id&#39;: 246, &#39;type&#39;: [&#39;uri&#39;]},
 &#39;schema:text&#39;: {&#39;property_id&#39;: 833,
  &#39;type&#39;: [&#39;literal&#39;, &#39;uri&#39;, &#39;resource:item&#39;]}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This time we'll build our data file in stages.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Add value for schema:name</span>
<span class="n">article</span><span class="p">[</span><span class="s1">&#39;schema:name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MR WRAGGE&#39;S PREDICTION. RENEWAL OF CYCLONE FORETOLD.&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You'll notice that this time I've only included the value of the property, not the data type. This is because <a href="/omeka_s_tools/api.html#OmekaAPIClient.prepare_item_payload_using_template"><code>OmekaAPIClient.prepare_item_payload_using_template</code></a> will insert default data types if they're not specified. The basic rules it uses if you don't supply a data type are:</p>
<ul>
<li>if the template defines a default data type, use that</li>
<li>if 'literal' is in the template's list of expected data types, use that</li>
<li>if 'literal' is not in the template's list of expected data types print a warning asking the user to specify a data type and drop the property from the payload</li>
</ul>
<p>In the case above, the 'literal' data type will be assigned to the <code>schema:name</code> value.</p>
<p>To create a link between the article and the newspaper it was published in, we can use <code>schema.isPartOf</code>. If we look in the list of template properties we see that this property expects a data type of 'resource:item'.</p>

<pre><code>'schema:isPartOf': {'property_id': 736, 'type': ['resource:item']}</code></pre>
<p>The 'resource:item' data type means that the value will be an identifier pointing to another Omeka item. So we include the identifier of the newly-created newspaper record. Once again, the data type will be automatically added when we generate the payload.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;schema:isPartOf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">newspaper_item</span><span class="p">[</span><span class="s1">&#39;o:id&#39;</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next we'll add the publication date. To recognise dates as specific data types, you need to install the <a href="https://omeka.org/s/modules/NumericDataTypes/">Numeric Data Types</a> module. Once that's done, you can set the 'numeric:timestamp' data type as the default for any date fields in your template. In the list of properties from the newspaper article template, you can see:</p>

<pre><code>'schema:datePublished': {'property_id': 928, 'type': ['numeric:timestamp']}</code></pre>
<p>The date value itself is supplied in a standard ISO format -- 'YYYY-MM-DD'.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;schema:datePublished&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1918-03-14&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally we'll add a link to the article. Once again the template includes a default data type.</p>

<pre><code>'schema:url': {'property_id': 393, 'type': ['uri']}</code></pre>
<p>So we can just include the value.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article</span><span class="p">[</span><span class="s1">&#39;schema:url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;http://nla.gov.au/nla.news-article226799674&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we've assembled the article metadata, we can generate a payload.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article_payload</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">prepare_item_payload_using_template</span><span class="p">(</span><span class="n">article</span><span class="p">,</span> <span class="n">article_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see below, the default data types have been inserted into the payload, and some additional fields have been added to define the link to the newspaper item.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article_payload</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;schema:name&#39;: [{&#39;property_id&#39;: 1116,
   &#39;type&#39;: &#39;literal&#39;,
   &#39;@value&#39;: &#34;MR WRAGGE&#39;S PREDICTION. RENEWAL OF CYCLONE FORETOLD.&#34;}],
 &#39;schema:datePublished&#39;: [{&#39;property_id&#39;: 928,
   &#39;type&#39;: &#39;numeric:timestamp&#39;,
   &#39;@value&#39;: &#39;1918-03-14&#39;}],
 &#39;schema:isPartOf&#39;: [{&#39;property_id&#39;: 736,
   &#39;type&#39;: &#39;resource:item&#39;,
   &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/712&#39;,
   &#39;value_resource_id&#39;: 712,
   &#39;value_resource_name&#39;: &#39;items&#39;}],
 &#39;schema:url&#39;: [{&#39;property_id&#39;: 393,
   &#39;type&#39;: &#39;uri&#39;,
   &#39;@id&#39;: &#39;http://nla.gov.au/nla.news-article226799674&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We could now go ahead and upload the payload to Omeka, but what if we want to include media files? In this case I have a JPG image of the article I want to attach. All you need to do is supply a list of paths pointing to media files using the <code>media_files</code> parameter. The list can just include the paths as strings, in which case the file name will be used as the media object's title. Alternatively, you can supply a list of dicts, each containing a <code>path</code> and <code>title</code> value.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">media_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;media/nla.news-article226799674-24144902.jpg&#39;</span><span class="p">]</span>

<span class="c1"># Include the media files when we upload the payload</span>
<span class="n">article_item</span> <span class="o">=</span> <span class="n">omeka_auth</span><span class="o">.</span><span class="n">add_item</span><span class="p">(</span><span class="n">article_payload</span><span class="p">,</span> <span class="n">media_files</span><span class="o">=</span><span class="n">media_files</span><span class="p">,</span> <span class="n">template_id</span><span class="o">=</span><span class="n">article_template_id</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we look at the uploaded item, we'll see that the media files have been processed and added to the record.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">article_item</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;@context&#39;: &#39;http://timsherratt.org/collections/api-context&#39;,
 &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/714&#39;,
 &#39;@type&#39;: &#39;o:Item&#39;,
 &#39;o:id&#39;: 714,
 &#39;o:is_public&#39;: True,
 &#39;o:owner&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/users/1&#39;,
  &#39;o:id&#39;: 1},
 &#39;o:resource_class&#39;: None,
 &#39;o:resource_template&#39;: {&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/resource_templates/4&#39;,
  &#39;o:id&#39;: 4},
 &#39;o:thumbnail&#39;: None,
 &#39;o:title&#39;: &#34;MR WRAGGE&#39;S PREDICTION. RENEWAL OF CYCLONE FORETOLD.&#34;,
 &#39;thumbnail_display_urls&#39;: {&#39;large&#39;: &#39;http://timsherratt.org/collections/files/large/1ba05f8df5df5f0003a4f4940aed209f0df53008.jpg&#39;,
  &#39;medium&#39;: &#39;http://timsherratt.org/collections/files/medium/1ba05f8df5df5f0003a4f4940aed209f0df53008.jpg&#39;,
  &#39;square&#39;: &#39;http://timsherratt.org/collections/files/square/1ba05f8df5df5f0003a4f4940aed209f0df53008.jpg&#39;},
 &#39;o:created&#39;: {&#39;@value&#39;: &#39;2022-01-26T01:56:28+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:modified&#39;: {&#39;@value&#39;: &#39;2022-01-26T01:56:28+00:00&#39;,
  &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#dateTime&#39;},
 &#39;o:media&#39;: [{&#39;@id&#39;: &#39;http://timsherratt.org/collections/api/media/715&#39;,
   &#39;o:id&#39;: 715}],
 &#39;o:item_set&#39;: [],
 &#39;o:site&#39;: [],
 &#39;schema:name&#39;: [{&#39;type&#39;: &#39;literal&#39;,
   &#39;property_id&#39;: 1116,
   &#39;property_label&#39;: &#39;name&#39;,
   &#39;is_public&#39;: True,
   &#39;@value&#39;: &#34;MR WRAGGE&#39;S PREDICTION. RENEWAL OF CYCLONE FORETOLD.&#34;}],
 &#39;schema:datePublished&#39;: [{&#39;type&#39;: &#39;numeric:timestamp&#39;,
   &#39;property_id&#39;: 928,
   &#39;property_label&#39;: &#39;datePublished&#39;,
   &#39;is_public&#39;: True,
   &#39;@value&#39;: &#39;1918-03-14&#39;,
   &#39;@type&#39;: &#39;http://www.w3.org/2001/XMLSchema#date&#39;}],
 &#39;schema:isPartOf&#39;: [{&#39;type&#39;: &#39;resource:item&#39;,
   &#39;property_id&#39;: 736,
   &#39;property_label&#39;: &#39;isPartOf&#39;,
   &#39;is_public&#39;: True,
   &#39;@id&#39;: &#39;http://timsherratt.org/collections/api/items/712&#39;,
   &#39;value_resource_id&#39;: 712,
   &#39;value_resource_name&#39;: &#39;items&#39;,
   &#39;url&#39;: None,
   &#39;display_title&#39;: &#39;The Bendigo Independent (Vic. : 1891 - 1918)&#39;}],
 &#39;schema:url&#39;: [{&#39;type&#39;: &#39;uri&#39;,
   &#39;property_id&#39;: 393,
   &#39;property_label&#39;: &#39;url&#39;,
   &#39;is_public&#39;: True,
   &#39;@id&#39;: &#39;http://nla.gov.au/nla.news-article226799674&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

